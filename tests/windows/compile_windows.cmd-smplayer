@echo off

set SMTUBE_SVN_DIR=..\..\smtube
set DEFS=
set SMTUBE_PARAMS=

if "%~1" == "" (

	set DEFS=
	set SMTUBE_PARAMS=
	goto compileSMPlayer

) else if "%~1" == "pe" (

	set DEFS="DEFINES+=PORTABLE_APP"
	set SMTUBE_PARAMS=pe
	goto compileSMPlayer

) else (

	echo How to use:
	echo.
	echo compile_windows.cmd [buildtype]
	echo.
	echo Compile SMPlayer Non-portable, enter no arguments.
	echo.
	echo pe:	SMPlayer ^(Portable^)
	echo.
	goto end

)

:compileSMPlayer

call getrev.cmd

if "%~1" == "pe" (
	echo Compiling SMPlayer Portable Edition
	echo.

)

cd zlib
mingw32-make -fwin32\makefile.gcc

cd ..\src
lrelease smplayer.pro
qmake %DEFS%
mingw32-make

if exist %SMTUBE_SVN_DIR% (

	cd %SMTUBE_SVN_DIR%
	compile_windows.cmd %SMTUBE_PARAMS%

) else (

	echo SMTube not found in specified directory... skipping

)

:end